# Kitty Terminal Configuration
# https://sw.kovidgoyal.net/kitty/conf/
#
# Migrated from Ghostty to solve AeroSpace tiling WM tab issue:
# Ghostty uses macOS native tabs (NSWindow) which appear as separate
# AXWindow objects, causing AeroSpace to tile each tab independently.
# Kitty uses its own custom tab bar, so AeroSpace sees a single window.

# ── Theme ──────────────────────────────────────────────────────────
# Catppuccin Mocha (unified across fish, tmux, neovim, waybar, alacritty, wezterm)
include current-theme.conf

# ── Font ───────────────────────────────────────────────────────────
font_family      JetBrainsMono Nerd Font
bold_font        auto
italic_font      auto
bold_italic_font auto
font_size        14.0

# CJK (Chinese/Japanese/Korean) font rendering
# Kitty auto-detects CJK glyphs and uses system fallback fonts.
# Explicitly set wide character ambiguous width for proper CJK alignment.
cjk_zero_width   no

# Ligature support (enabled by default in Kitty via HarfBuzz)
disable_ligatures never

# ── Performance (OLED-optimized) ───────────────────────────────────
# Low repaint delay for smooth rendering on high-refresh OLED displays
repaint_delay    8
input_delay      1
sync_to_monitor  yes

# ── Scrollback ─────────────────────────────────────────────────────
scrollback_lines 100000

# ── Window / Tab bar ───────────────────────────────────────────────
# Kitty's custom tab bar = single window in AeroSpace (the whole point)
tab_bar_edge     top
tab_bar_style    powerline
tab_powerline_style slanted
tab_title_template "{index}: {title}"

# Window layout
window_padding_width 0
remember_window_size yes

# macOS-specific
macos_option_as_alt       no
macos_quit_when_last_window_closed no
macos_titlebar_color      background
macos_show_window_title_in none

# Wayland-specific (for Hyprland on Linux)
wayland_titlebar_color    background
linux_display_server      auto

# ── Bell ───────────────────────────────────────────────────────────
enable_audio_bell no
visual_bell_duration 0.0

# ── Cursor ─────────────────────────────────────────────────────────
cursor_shape     beam
cursor_blink_interval 0

# ── Mouse ──────────────────────────────────────────────────────────
url_style        curly
open_url_with    default
copy_on_select   no

# ── Shell integration ──────────────────────────────────────────────
shell_integration enabled

# ── Keyboard shortcuts ─────────────────────────────────────────────
# Philosophy: avoid Cmd+H/J/K/L and Cmd+1-9 (used by AeroSpace)
# Use Cmd+Shift or Ctrl+Shift for Kitty-internal actions.
#
# NOTE: Alt/Option keybindings avoided (macOS 26 Tahoe intercepts them)

# Clear all default shortcuts first, then define explicitly
# clear_all_shortcuts yes   # Uncomment to start from scratch

# ── Tab management (Cmd+T / Cmd+W / Cmd+Shift+arrows) ─────────────
map cmd+t       new_tab
map cmd+w       close_tab
map cmd+shift+] next_tab
map cmd+shift+[ previous_tab
map cmd+shift+right move_tab_forward
map cmd+shift+left  move_tab_backward

# ── Window (split) management ──────────────────────────────────────
map cmd+d         new_window
map cmd+shift+d   close_window
map ctrl+shift+]  next_window
map ctrl+shift+[  previous_window

# ── Scrollback ─────────────────────────────────────────────────────
map cmd+shift+k   scroll_line_up
map cmd+shift+j   scroll_line_down
map cmd+shift+u   scroll_page_up
map cmd+shift+n   scroll_page_down
map cmd+shift+home scroll_home
map cmd+shift+end  scroll_end

# ── Font size ──────────────────────────────────────────────────────
map cmd+plus     change_font_size all +1.0
map cmd+minus    change_font_size all -1.0
map cmd+0        change_font_size all 0

# ── Clipboard ─────────────────────────────────────────────────────
map cmd+c        copy_to_clipboard
map cmd+v        paste_from_clipboard

# ── Misc ───────────────────────────────────────────────────────────
map cmd+shift+f5 load_config_file
map cmd+shift+f6 debug_config
map ctrl+shift+f5 load_config_file
